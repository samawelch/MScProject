library(growthcurver)
library(gridBase)
library(gridExtra)
library(ggpubr)
library(here)
library(viridis)
interaction_order_vector <- c("A", "B", "Additive", "+S", "-S", "+A", "-A" )
interaction_colour_vector <- c("A" = "#440154","B" = "#440154","Additive" = "#22a884", "+S" = "#fde725","-S" = "#7ad151", "+A" = "#2a788e", "-A" = "#414487" )
setwd(here("Scripts"))
data <- read.csv("Data/Expanded_Interaction_Definition_Data.csv")
data1 <- filter(data, Example == 1)
p1 <- ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
data2 <- filter(data, Example == 2)
p2 <- ggplot(data = data2) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Opposing Interactions", subtitle = "Example: Antibacterial x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
data3 <- filter(data, Example == 3)
p3 <- ggplot(data = data3) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Positive Interactions", subtitle = "Example: Food Source x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
setwd(here("Scripts","Results"))
pdf("Plot_Interactions_Illustrative.pdf", height = 3, width = 9)
annotate_figure(
ggarrange(p1,p2,p3, ncol = 3, nrow = 1),
left = text_grob("Response", rot = 90))
dev.off()
interaction_colour_vector <- c("A" = "#440154","B" = "#440154","Additive" = "#22a884", "+S" = "#fde725","-S" = "#2a788e", "+A" = "#414487", "-A" = "#7ad151")
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
ggplot(data = data2) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Opposing Interactions", subtitle = "Example: Antibacterial x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
# Generate a graphic to depict extended definitions of stressor interactions
# Based on Figure 2 of Piggott, Townsend and Mathaei (2015)
# TODO: Refine these graphics more, whether that means bringing them in line with PGM(2015) or modifying them...
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
library(growthcurver)
library(gridBase)
library(gridExtra)
library(ggpubr)
library(here)
library(viridis)
interaction_order_vector <- c("A", "B", "Additive", "+S", "-S", "+A", "-A" )
interaction_colour_vector <- c("A" = "#440154","B" = "#440154","Additive" = "#22a884", "+S" = "#fde725","-S" = "#7ad151", "+A" = "#414487", "-A" = "#2a788e")
setwd(here("Scripts"))
data <- read.csv("Data/Expanded_Interaction_Definition_Data.csv")
data1 <- filter(data, Example == 1)
p1 <- ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
data2 <- filter(data, Example == 2)
p2 <- ggplot(data = data2) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Opposing Interactions", subtitle = "Example: Antibacterial x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
data3 <- filter(data, Example == 3)
p3 <- ggplot(data = data3) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Response") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Positive Interactions", subtitle = "Example: Food Source x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
setwd(here("Scripts","Results"))
pdf("Plot_Interactions_Illustrative.pdf", height = 3, width = 9)
annotate_figure(
ggarrange(p1,p2,p3, ncol = 3, nrow = 1),
left = text_grob("Response", rot = 90))
dev.off()
install.packages(sjPlot)
install.packages("sjPlot")
library(sjPlot)
?sjPlot
# load libraries
library(sjPlot)  # for plotting
library(sjmisc)  # for sample data
library(ggplot2) # to access ggplot-themes
# load sample data set
data(efc)
set_theme(
geom.outline.color = "antiquewhite4",
geom.outline.size = 1,
geom.label.size = 2,
geom.label.color = "grey50",
title.color = "red",
title.size = 1.5,
axis.angle.x = 45,
axis.textcolor = "blue",
base = theme_bw()
)
sjp.grpfrq(
efc$e42dep,
efc$e16sex,
title = NULL,
geom.colors = c("cadetblue", "coral"),
geom.size = 0.4
)
# Generate a graphic to depict extended definitions of stressor interactions
# Based on Figure 2 of Piggott, Townsend and Mathaei (2015)
# TODO: Refine these graphics more, whether that means bringing them in line with PGM(2015) or modifying them...
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
library(growthcurver)
library(gridBase)
library(gridExtra)
library(ggpubr)
library(here)
library(viridis)
interaction_order_vector <- c("A", "B", "Additive", "+S", "-S", "+A", "-A" )
interaction_colour_vector <- c("A" = "#440154","B" = "#440154","Additive" = "#22a884", "+S" = "#fde725","-S" = "#7ad151", "+A" = "#414487", "-A" = "#2a788e")
setwd(here("Scripts"))
data <- read.csv("Data/Expanded_Interaction_Definition_Data.csv")
data1 <- filter(data, Example == 1)
p1 <- ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
data2 <- filter(data, Example == 2)
p2 <- ggplot(data = data2) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Opposing Interactions", subtitle = "Example: Antibacterial x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
data3 <- filter(data, Example == 3)
p3 <- ggplot(data = data3) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Positive Interactions", subtitle = "Example: Food Source x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
setwd(here("Scripts","Results"))
pdf("Plot_Interactions_Illustrative.pdf", height = 3, width = 9)
annotate_figure(
ggarrange(p1,p2,p3, ncol = 3, nrow = 1),
left = text_grob("Stressor Effect", rot = 90))
dev.off()
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
?scale_y_continuous
scale x discrete
scale_x_discrete
?scale_x_discrete
?annotate
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank()) +
annotate("text", label  =minor_interaction_labels)
minor_interaction_labels <- c("", "", "i", "ii", "iii", "iv", "v")
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank()) +
annotate("text", label  =minor_interaction_labels)
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank()) +
annotate("text", label = minor_interaction_labels, y = -7)
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank()) +
annotate("text", label = minor_interaction_labels, y = -7, x = 1)
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
interaction_order_vector <- c("A", "B", "Additive\ni", "+S\nii", "-S\niii", "+A\niv", "-A\nv" )
ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector, labels = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
# Generate a graphic to depict extended definitions of stressor interactions
# Based on Figure 2 of Piggott, Townsend and Mathaei (2015)
# TODO: Refine these graphics more, whether that means bringing them in line with PGM(2015) or modifying them...
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
library(growthcurver)
library(gridBase)
library(gridExtra)
library(ggpubr)
library(here)
library(viridis)
interaction_order_vector <- c("A", "B", "Additive\n(i)", "+S\n(ii)", "-S\n(iii)", "+A\n(iv)", "-A\n(v)" )
interaction_colour_vector <- c("A" = "#440154","B" = "#440154","Additive" = "#22a884", "+S" = "#fde725","-S" = "#7ad151", "+A" = "#414487", "-A" = "#2a788e")
minor_interaction_labels <- c("", "", "i", "ii", "iii", "iv", "v")
setwd(here("Scripts"))
data <- read.csv("Data/Expanded_Interaction_Definition_Data.csv")
data1 <- filter(data, Example == 1)
p1 <- ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector, labels = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
data2 <- filter(data, Example == 2)
p2 <- ggplot(data = data2) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector, labels = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Opposing Interactions", subtitle = "Example: Antibacterial x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
data3 <- filter(data, Example == 3)
p3 <- ggplot(data = data3) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector, labels = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Positive Interactions", subtitle = "Example: Food Source x Food Source") +
theme(axis.text.x = element_text(size = 10, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
setwd(here("Scripts","Results"))
pdf("Plot_Interactions_Illustrative.pdf", height = 3, width = 9)
annotate_figure(
ggarrange(p1,p2,p3, ncol = 3, nrow = 1),
left = text_grob("Stressor Effect", rot = 90))
dev.off()
# Generate a graphic to depict extended definitions of stressor interactions
# Based on Figure 2 of Piggott, Townsend and Mathaei (2015)
# TODO: Refine these graphics more, whether that means bringing them in line with PGM(2015) or modifying them...
library(dplyr)
library(tibble)
library(tidyr)
library(ggplot2)
library(growthcurver)
library(gridBase)
library(gridExtra)
library(ggpubr)
library(here)
library(viridis)
interaction_order_vector <- c("A", "B", "Additive\n(i)", "+S\n(ii)", "-S\n(iii)", "+A\n(iv)", "-A\n(v)" )
interaction_colour_vector <- c("A" = "#440154","B" = "#440154","Additive" = "#22a884", "+S" = "#fde725","-S" = "#7ad151", "+A" = "#414487", "-A" = "#2a788e")
minor_interaction_labels <- c("", "", "i", "ii", "iii", "iv", "v")
setwd(here("Scripts"))
data <- read.csv("Data/Expanded_Interaction_Definition_Data.csv")
data1 <- filter(data, Example == 1)
p1 <- ggplot(data = data1) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector, labels = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Negative Interactions", subtitle = "Example: Antibacterial x Antibacterial") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank())
data2 <- filter(data, Example == 2)
p2 <- ggplot(data = data2) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector, labels = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Opposing Interactions", subtitle = "Example: Antibacterial x Food Source") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
data3 <- filter(data, Example == 3)
p3 <- ggplot(data = data3) +
geom_rect(aes(ymin = ymin, ymax = ymax, xmax = ID - 0.45, xmin = ID + 0.45, fill = Interaction)) +
ylab(label = "Stressor Effect") +
scale_x_discrete(limits = interaction_order_vector, labels = interaction_order_vector) +
scale_fill_manual(values = interaction_colour_vector, breaks = interaction_order_vector) +
scale_y_continuous(expand = c(0,0),
limits = c(-5.5, 5.5),
breaks = c(-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5)) +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.y = element_blank()) +
ggtitle(label = "Double Positive Interactions", subtitle = "Example: Food Source x Food Source") +
theme(axis.text.x = element_text(size = 9, angle = 0),
legend.position = "none",
axis.title.y = element_blank(),
axis.text.y = element_blank())
setwd(here("Scripts","Results"))
pdf("Plot_Interactions_Illustrative.pdf", height = 3, width = 9)
annotate_figure(
ggarrange(p1,p2,p3, ncol = 3, nrow = 1),
left = text_grob("Stressor Effect", rot = 90))
dev.off()
